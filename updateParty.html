<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <script src="https://www.eformsign.com/plugins/jquery/jquery.min.js"></script>

    <script src="https://www.eformsign.com/lib/js/efs_embedded_v2.js"></script>

    <script src="https://www.eformsign.com/lib/js/efs_redirect.js"></script>
    <script src="https://www.eformsign.com/lib/js/efs_embedded_form.js"></script>  
<style>
    /* 공통 스타일 */
    body {
            margin: 0;
            font-family: Arial, sans-serif;
        }

        /* 메뉴 바의 기본 스타일 */
        .navbar {
            display: flex;
            justify-content: space-between;
            background-color: #333;
            padding: 10px 20px;
            color: white;
            font-size: 16px;
        }

        .navbar a {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            display: block;
        }

        .navbar a:hover {
            background-color: #ddd;
            color: black;
        }

        .navbar3 {
            background-color: #f44336;
        }

        /* 템플릿 수정 메뉴 스타일 */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f1f1f1;
            min-width: 160px;
            z-index: 1;
            top: 100%;
            left: 0;
        }

        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

        .dropdown-content a:hover {
            background-color: #ddd;
        }

        /* 드롭다운 메뉴 활성화 */
        .dropdown:hover .dropdown-content {
            display: block;
        }

        /* 메뉴 항목에 마우스를 올릴 때 효과 */
        .navbar a:hover {
            background-color: #ddd;
            color: black;
        }

</style>

</head>
<body>
    <h1 style="text-align: center">관리자 홈페이지</h1>
    <!-- 세 번째 메뉴 바 -->
    <div class="navbar navbar3">
        <div class="dropdown">
            <a href="javascript:void(0)" onclick="updateLink('applicantList')">지원자 목록</a>
        </div>
        <a href="#careers">일괄 전송</a>
        <div class="dropdown">
            <a href="#">템플릿 수정</a>
            <div class="dropdown-content">
                <a href="javascript:void(0)" onclick="updateLink('supportForm')">지원서 수정</a>
                <a href="javascript:void(0)" onclick="updateLink('invitationCard')">초대장 수정</a>
            </div>
        </div>
    </div>
    <script>
        // 링크 업데이트 함수
        function updateLink(section) {
            let newLink = "";

            switch(section) {
                case 'applicantList':
                    newLink = "/admin.html";  // 지원자 목록 페이지로 이동
                    break;
                case 'careers':
                    newLink = "/check.html";  // 일괄 전송 페이지로 이동
                    break;
                case 'supportForm':
                    newLink = "/updateApply.html";  // 지원서 수정 페이지로 이동
                    break;
                case 'invitationCard':
                    newLink = "/updateParty.html";  // 초대장 수정 페이지로 이동
                    break;
                default:
                    console.log("잘못된 섹션");
                    return;
            }

            // 해당 링크로 이동
            window.location.href = newLink;
        }
    </script>
    <!-- 초대장 수정 내용 -->
    <div id="invitationCard" class="edit-section">
        <h2>초대장 수정</h2>
        <p>여기에는 초대장을 수정할 수 있는 폼을 추가합니다.</p>
        <!-- 여기에 실제 수정할 폼 등을 추가할 수 있습니다. -->
        <iframe id="eformsign_iframe" name="eformsign_iframe" style="width: 1200px; height: 1400px;"></iframe>
        <script>
            var eformsign = new EformSignTemplate();
            function getCookie(name) {
    const matches = document.cookie.match(new RegExp(
        "(?:^|; )" + name.replace(/([.$?*|{}()\[\]\/\\+^])/g, '\\$1') + "=([^;]*)"
    ));
    return matches ? matches[1] : undefined;
}

// 쿠키에서 access_token과 refresh_token 가져오기
const accessToken = getCookie('access_token');
const refreshToken = getCookie('refresh_token');

            var template_option = {
                "company" : {
                    "id" : "81048d296e2c46a9b181c901198d7c23",            // Company ID 입력
                    "country_code" : "kr",    // 국가 코드 입력 (ex: kr)
                    "user_key": "orange875321@naver.com"        // 임베딩한 고객 측 시스템에 로그인한 사용자의 unique key. 브라우저 쿠키의 이폼사인 로그인 정보와 비교
                },
                "user" : {
                    "id": "orange875321@naver.com",
                    "access_token" : accessToken,    // Access Token 입력 (OpenAPI Access Token 참조)
                    "refresh_token" : refreshToken,   // Refresh Token 입력 (OpenAPI Access Token 참조)
                },
                "mode" : {
                    "type" : "02",      // 01 : 생성 , 02 : 수정, 03 : 복제
                    "template_id" : "9daa0dc7ad8a4b488f091c7840e7af08", // template id 입력
                    "template_type": "form" // form : 템플릿 관리, unstructured_form: 내 파일로 문서 작성
                },
                "layout" : {
                    "lang_code" : "ko", // 이폼사인 언어. ko, en, ja
                    "header" : true,    // 상단바 (푸른색) 표시 여부. 미표시 시 액션 버튼을 통해 전송 등 동작 가능
                    "footer" : true     // 하단바 (이폼사인 로고, 언어 설정 등) 표시 여부.
                },
};

//callback option
var success_callback = function (response) {
    if (response.type ==='template'){
        console.log(response.template_id);
        console.log(response.template_name);
        console.table(response.step_settings);
        if ("-1" == response.code) {
            alert("템플릿 생성되었습니다.\n" + "- document_id : " + response.template_id + "\n- title : " + response.template_name);
        } else {
            alert("템플릿 생성에 실패하였습니다.\n" + "- code : " + response.code + "\n- message : " + response.message);
        }
    }
    window.close();
};


var error_callback = function (response) {
    alert("템플릿 생성에 실패하였습니다.\n" + "- code : " + response.code + "\n- message : " + response.message);
    console.log(response.code);
    console.log(response.message);
    window.close();
};

var action_callback = function (response) {
    console.table(response.data);
};

eformsign.template(template_option, "eformsign_iframe", success_callback, error_callback, action_callback);
eformsign.open();
</script>
    </div>
</body>